#!/bin/bash
fi="INSTALL-INFO:"
flag="-Sy --needed --noconfirm"
pc="sudo pacman $flat" # pacman-flag-option
pr="	   paru $flat" # pacman-flag-option
fkflag="-y --noninteractive"

# time duration
# hp-laptop: 1h27m - 31G

# to change
# npm is not installed in pm
# install paru in pm (fakeroot + debugedit + pkg-config + patch needed)

# scripts
# some tools to measure the time of individual flag(in this file) costs time/storage(+ which machine) + entire system installation
# -thin for the thinclient option.
#   maybe use it with Continous Deployment (test on other machines and make these so-called "units-tests" )
#   for tailscale - but when the internet it too low, then i'm looking forward to mirror/clone my client to my mein-pc
# visualize all progs that i have already download, and which from this file here, not.
#   and find packges, when they failt
# get inspritation in the comments of ./os-install
# get notified when some process wait for sudo-access
# the file here should only show the packags with the segregation.
#   but another script will combine all other ones in the one flag-option into one line(or 2 bc of pacman/aur).

# progs to avoid (swich to '-po' of time duration reasons)
# most of rust
#   wluma
# 


# automatisation
# onedrive-* (but why I use it when i have rclone?)

# changelog
# warp-terminal-bin - yay arm support 
#(maybe write an event handler to notify for more packages that become arm compatible?)

# shortcuts
# wit = what is this
# !arm = no support for ARM archicture (a note to manage it seperately)

# -- --
# wit
# -- --
# helvum
#
#
#
#

# OPTIONS
# -sys
# -deps
# -ex
#
# fX -> flatpak
# X(m/o) -> main/others
# pX -> pacman
# fX -> flatpak
#
# -aur
# -nerd
#
#
if [[ "$*" == *"-h"* ]]; then

	 echo "OPTIONS"
	 echo "-------"
	 echo "-sys"
	 echo "-deps"
	 echo "-ex"
	 echo	
	 echo "X(m/o) -> main/others"
	 echo
	 echo "pX -> pacman"
	 echo "fX -> flatpak"
	 echo
	 echo "-aur"
	 echo "-nerd"
	 echo
	 echo "-a"
	 echo "-all (same as -nerd)"
	 echo
fi




if [[ "$*" == *"-sys"* || "$*" == *"-a"* ]]; then
	echo "$fi (-sys) Installing System Prog's"
	$pc wireplumber iwd
	$pc pipewire pipewire-alsa pipewire-pulse pipewire-audio
	$pc alsa-tools alsa-utils alsa-firmware # [P]
	$pc helvum tailscale   
fi


# Required uncommented section about [multilib] in /etc/pacman.conf
if [[ "$*" == *"-deps"* || "$*" == *"-a"* ]]; then
	echo "$fi Installing Libs"
	$pc pkgconf gcc clang ccache cargo trunk rustup go wayland wl-clipboard xclip ydotool wlr-randr base-devel debugedit fakeroot # [P]
	echo "$fi Installing Drivers"
	$pc xf86-video-intel mesa lib32-mesa vulkan-tools vulkan-intel lib32-vulkan-intel # [P]
	# FOSS-Drivers (For experimental Purposes)
	# $pc vulkan-nouveau lib32-vulkan-nouveau xf86-video-nouveau
	# $pc lib32-nvidia-utils nvidia-utils # For newer GPU's

	# for hp laptop
	#$pr lib32-nvidia-470xx-utils # [A]

	# nvidia-470xx-utils nvidia-470xx-dkms # Install these manually
	# $pc opencl-nvidia-470xx # Propably already in some of these packages included
fi


if [[ "$*" == *"-ex"* || "$*" == *"-a"* ]]; then
	echo "$fi (-ex) Installing exernal's"
	rustup default stable
	cargo install --list | rg -q "i3bar-river" && echo "i3bar-river already exists" || cargo install --locked i3bar-river
	# +river-shifttags 
	cargo install --list | rg -q "river-shifttags" || {
		echo "Installing river-shifttags manually"
		trgt="$HOME/repo/river-shifttags/"
		mkdir -p "$trgt"
		git clone https://gitlab.com/akumar-xyz/river-shifttags.git "$trgt"
		(cd "$trgt" && make && sudo make install)
	}
fi


# pacman
if [[ "$*" == *"-pm"* || "$*" == *"-a"* ]]; then
	echo "$fi (-pm) Installing main pacman's"

	# Unsorted
	$pc npm github-cli

	# Core terminal tools
	$pc bash bat evtest eza fd firefox flatpak i3status-rust kitty less man reptyr river swww plasma-desktop rofi starship tmux vifm vim wev zoxide # [P]

	# Communication & News
	$pc croc neomutt whatsie ttyd kdeconnect # [P]
	$pr weechat-matrix # [A]
	$pc canto-curses newsboat # [P]

	# Browsers (terminal)
	$pr browsh creddit-git daylight ferroxide luakit-git reddio reddit-tui-bin wppfzf # [A]

	# Networking (core, advanced) + helpers
	$pc arp-scan borg dhcpcd dhcpcd dhclient fail2ban iproute2 nmap nm-connection-editor net-tools networkmanager rclone rsync syncthing ufw wpa_supplicant # [P]

	$pc netstat ss lsof # dirty

	$pc aircrack-ng avahi mtr nss-mdns tcpdump tracepath traceroute wireless_tools # [P]
	$pr nm-tray odhcpd-git # [A]

	# Connectivity
	$pc bluetui connman cyme kdeconnect wavemon # [P]

	# Cloud & Sync
	$pr megatools micromamba onedrive-abraunegg pcloud-drive pcloudcc-git proot # [A]
	$pc fyi inotify-tools # [P]
	$pr ngrok nm-tray ntfysh-bin odhcpd-git # [A]

	# Security / Firewall
	$pc firewalld fuse2 # [P]

	# System info & GPU
	$pc i2c-tools mangohud nvidia-utils scrcpy wine wlr-randr # [P]
	$pr drm_info powerstat-git # [A]

	# Monitoring & Wellness
	$pc batsignal # [P]
	$pr safeeyes stretchly-bin wluma # [A]

	# Text processing
	$pc htmlq jq # [P]
	$pr basalt jqp-bin mdfried-bin pinfo pup # [A]

	# File management
	$pc diskonaut dust ncdu pkgfile plocate termdown tree # [P]

	# Productivity
	$pc jrnl zk birthday # [P]
	$pc task vit obsidian # [P]
	$pr calendar-cli taskvanguard wish # [A] # build fails
	$pc remind timew # [P]

	# Documentation
	$pc asciidoc check-docs doxygen man-pages man-pages-de # [P]
	$pc wikiman wiki-tui # [P]
	# removed: wiki-ncurses (not found)

	# PDF & Recording
	$pc asciinema eyedropper grim hyprpicker poppler slurp wf-recorder # [P]
	$pr tdf-git tplay-git wl-screenrec-git # [A]

	# Session tools
	$pr sesh-bin swhkd-bin # [A]

	# CLI UI
	$pc broot glow gum # [P]

	# TUI / Games / ASCII
	$pc asciiquarium banner boinctui figlet # [P]
	$pc crawl-ncurses mari0 warsow # [P]
	$pc dhex # [P]

	# Cursors / tools
	$pc expac # [P]
	$pr bibata-cursor-bin bibata-cursor-git # [A]

	# Python tools (AUR python-*)
	py=(archspec uv)
	for p in "${py[@]}"; do $pr "python-$p"; done

	# Git tools
	$pr lazygit-git legit-git nodejs-git-stats gh-heats forge-sparks # [A]

	# AI
	$pc amfora ollama pyenv # [P]
	$pr agate-bin asuka-git telescope warp-terminal-bin # [A]
	$pc tgpt # [P]
	sudo npm install -g @google/gemini-cli@latest

	# fonts (+ monocraft/..)
	$pr ttf-fira-code

fi

if [[ "$*" == *"-po"* || "$*" == *"-a"* ]]; then
	echo "$fi (-po) Installing other pacman's"
	# split long line, keep PACMAN-only here
	$pc docker docker-compose ffmpeg mako podman tigervnc waylock wayvnc w3m zathura # [P]
	$pc bluetui ccache cmake ncurses ninja nix openssh sshfs wireshark-cli # [P]
	$pc cmus fail2ban fastfetch firewalld gnuplot mpv octave playerctl ripgrep speedtest-cli tealdeer ufw vlc # [P]
	$pc btop chafa glances networkmanager iotop net-tools netctl netdata netplan python-pip sdl2 sdl3 viu # [P]
	$pc avahi binsider dtc figlet glib-networking gobuster pandoc qrencode socat spinner strace traceroute # [P]
	$pc inetutils # [P]
	# AUR moved out of PACMAN line
	$pr archivebox-git chs-git p4 wppfzf # [A]

	# Trading
	$pr tradingview # !arm [A]

	# Misc utils
	$pc eom lorem mokutil ncmpcpp # [P]
	$pr uci-git # [A]

	# Fun
	$pc lolcat # [P]
	$pc clairvoyant cowfortune cowsay ponysay # [P]

	# Creative
	$pc audacity blender drawing f3d gimp godot krita pencil2d synfig # !arm [P]
	$pc fluidsynth lmms reaper # [P]
	$pr bespokesynth bitwig-studio zrythm # [A]






fi


# flatpak
if [[ "$*" == *"-fm"* || "$*" == *"-a"* ]]; then
	echo "$fi (-fm)  Installing main flatpak's"
	flatpak install $fkflag  flathub org.audacityteam.Audacity
	flatpak install $fkflag flathub com.saivert.pwvucontrol
fi


if [[ "$*" == *"-fo"* || "$*" == *"-a"* ]]; then
	echo "$fi (-fo)  Installing other flatpak's"
	flatpak install $fkflag flathub org.chromium.Chromium
fi


if [[ "$*" == *"-aur"* || "$*" == *"-a"* ]]; then
	echo "$fi (-aur) -Installing AUR packages"
	# keep only AUR here
	$pr bluealsa brave-git latex-mk mosh mosh-agent rofi-emoji-git tailscale zerotier-one # [A]
fi


if [[ "$*" == *"-games"* || "$*" == *"-a"* ]]; then
	echo "$fi (-nerd) Installing Games(Steam, Flathub, .."
	flatpak install $fkflag flathub com.valvesoftware.Steam
	$pr polymc-qt5-bin # [A]
fi

if [[ "$*" == *"-nerd"* || "$*" == *"-all"* ]]; then
	echo "$fi (-nerd) Installing ALL Nerd-Fonts(HEAVY ~10GB)"
	# $pc $(pacman -S nerd-fonts | cut -d/ -f2 | cut -d' ' -f1)
	$pc otf-firamono-nerd ttf-firacode-nerd # [P]
	# bibata cursor / monocraft
fi

if [[ "$*" == *"-o"* || "$*" == *"-a"* ]]; then
	echo "$fi (-o) Installing Other stuff"
	$pc ffmpegthumbnailer imagemagick lf ttf-ms-win11-auto ueberzugpp # [P]
	$pr drm_info fontpreview polymc powerstat-git # [A]
	# pacman extras
	$pc dracut mokutil poppler # [P]
	#https://github.com/thimc/vifmimg?tab=readme-ov-file
	# $pr steam-devices-git
fi


if [[ "$*" == *"-g"* || "$*" == *"-a"* ]]; then
	echo "$fi (-o) Installing github-cli Extensions"
	gh extension install benelan/gh-notify-desktop # for i3 but with -cP
	gh extension install github/gh-copilot # mb better than tt
	gh extension install jrnxf/gh-eco # cool preview for user profiles
	gh extension install gennaro-tedesco/gh-s # basic repo search
	gh extension install mona-actions/gh-repo-stats
	gh extension install korosuke613/gh-user-stars
	gh extension install vilmibm/gh-screensaver

	gh extension install dlvhdr/gh-dash # for pr
	gh extension install github/gh-net # hmm, maybe having codespace in cli?
	gh extension install KOBA789/gh-sql
	gh extension install github/gh-skyline # mb for cool dashboards/preview (inspiration)

	# propably there is some way to install (1), but i could not found (dont wan't to spend time to search)
	# (1): https://github.com/kardolus/chatgpt-cli
	gh ext install redraw/gh-install
fi



# Later 
## Syntax: flatpak install -y flathub org.kde.krita ...

## ..'s -> ..s

## 4. Eleganter: case statt if [[ "$*" == *"-x"* ]]
## Du könntest über ein Rework mit for arg in "$@"; do case $arg in ...) nachdenken – ist aber Geschmackssache. 

## GREEN="\033[0;32m"
## RESET="\033[0m"
## fi="${GREEN}INSTALL-INFO:${RESET}"

## Subcatergoies (Essential, Optional, ..)

# ==========================================
# INVALID/UNKNOWN PACKAGES from progs.log (not found)
# ==========================================
# already
# arm
# cargo
# cut
# day
# dhcpd
# For
# gh-heats
# included
# Intel
# Intergrated
# ip-utils
# maany
# man
# matrix-nio
# mautrix
# msmtf
# nc
# nerd-fonts
# newer
# of
# packages
# pacman-flag-option
# pandoc
# Propably
# some
# space
# spinner
# support
# texlive-lang
# texlive-most
# these
# tracepath
# wifi-menu
# wifi-tools
# wiki-ncurses

